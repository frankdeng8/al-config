#!/bin/bash
#
# Copyright Â© 2019 Oracle Corp., Inc.  All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at http://oss.oracle.com/licenses/upl
#
# activate_known_exploit_detection.sh: Activate known exploit detection
#

. /usr/lib/al-config/functions

usage() {
    cat >&2 << EOF
Usage: $0 [OPTION]...
 -h This message
EOF
    exit 1
}

run_as_root_check

while getopts "h" OPTION; do
    case "$OPTION" in
      h)
        usage
        ;;
      *)
        usage
        ;;
    esac
done

if is_known_exploit_detection_activated; then
    log "Known exploit detection is already activated."
    exit 0
fi
# Activate know exploit detection
activate_known_exploit_detection

# Verify
if is_known_exploit_detection_activated; then
    log "Activated known exploit detection."
else
    log "Failed to activate known exploit detection."
fi
